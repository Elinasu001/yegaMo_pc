function GenECKeyPair(a){a=getSECCurveByName(a);var c=new SecureRandom,b=new BigInteger(a.getN().toString()),d=b.subtract(BigInteger.ONE),c=(new BigInteger(b.bitLength(),c)).mod(d).add(BigInteger.ONE),b=new ECCurveFp(new BigInteger(a.getCurve().getQ().toString()),new BigInteger(a.getCurve().getA().toBigInteger().toString()),new BigInteger(a.getCurve().getB().toBigInteger().toString()));a=new ECPointFp(b,b.fromBigInteger(new BigInteger(a.getG().getX().toBigInteger().toString())),b.fromBigInteger(new BigInteger(a.getG().getY().toBigInteger().toString())));
this.priKey=c.toString(16);this.pubKey=b.encodePointHex(a.multiply(c))}function getECPrivateKey(){return this.priKey}function getECPublicKey(){return this.pubKey}GenECKeyPair.prototype.getPriKey=getECPrivateKey;GenECKeyPair.prototype.getPubKey=getECPublicKey;
function DeriveECKey(a,c,b){a=getSECCurveByName(a);b=(new ECCurveFp(new BigInteger(a.getCurve().getQ().toString()),new BigInteger(a.getCurve().getA().toBigInteger().toString()),new BigInteger(a.getCurve().getB().toBigInteger().toString()))).decodePointHex(b);c=new BigInteger(c,16);c=b.multiply(c).getX().toBigInteger().toString(16);return HexStrCheck(c)}
function SEEDEncrypt(a,c,b,d){if(a!=nSaferJS.mode.CFB)return"";b=nSaferJS.enc.Hex.parse(b);c=nSaferJS.enc.Hex.parse(c);return nSaferJS.SEED.encrypt(d,b,{iv:c,mode:a,padding:nSaferJS.pad.NoPadding}).ciphertext.toString()}function SEEDDecrypt(a,c,b,d){if(a!=nSaferJS.mode.CFB)return"";b=nSaferJS.enc.Hex.parse(b);c=nSaferJS.enc.Hex.parse(c);return nSaferJS.SEED.decrypt(HexStr2Base64(d),b,{iv:c,mode:a,padding:nSaferJS.pad.NoPadding}).toString()}
function HexStr2Base64(a){return nSaferJS.enc.Base64.stringify(nSaferJS.enc.Hex.parse(a))}function Base642HexStr(a){return nSaferJS.enc.Hex.stringify(nSaferJS.enc.Base64.parse(a))}function HexStr2Utf8(a){return nSaferJS.enc.Hex.parse(a).toString(nSaferJS.enc.Utf8)}function Utf82HexStr(a){return nSaferJS.enc.Hex.stringify(nSaferJS.enc.Utf8.parse(a))}function HexStrCheck(a){return a.length%2?"0"+a:a};