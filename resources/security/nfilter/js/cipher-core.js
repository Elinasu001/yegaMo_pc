nSaferJS.lib.Cipher||function(t){var f=nSaferJS,e=f.lib,h=e.Base,k=e.WordArray,p=e.BufferedBlockAlgorithm,q=f.enc.Base64,u=f.algo.EvpKDF,m=e.Cipher=p.extend({cfg:h.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c);this._xformMode=a;this._key=b;this.reset()},reset:function(){p.reset.call(this);this._doReset()},process:function(a){this._append(a);
return this._process()},finalize:function(a){a&&this._append(a);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){return function(a){return{encrypt:function(b,c,d){return("string"==typeof c?r:g).encrypt(a,b,c,d)},decrypt:function(b,c,d){return("string"==typeof c?r:g).decrypt(a,b,c,d)}}}}()});e.StreamCipher=m.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var l=f.mode={},v=e.BlockCipherMode=h.extend({createEncryptor:function(a,
b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a;this._iv=b}}),l=l.CBC=function(){function a(a,b,w){var c;(c=this._iv)?this._iv=t:c=this._prevBlock;for(var d=0;d<w;d++)a[b+d]^=c[d]}var b=v.extend();b.Encryptor=b.extend({processBlock:function(b,d){var c=this._cipher,e=c.blockSize;a.call(this,b,d,e);c.encryptBlock(b,d);this._prevBlock=b.slice(d,d+e)}});b.Decryptor=b.extend({processBlock:function(b,d){var c=this._cipher,
e=c.blockSize,f=b.slice(d,d+e);c.decryptBlock(b,d);a.call(this,b,d,e);this._prevBlock=f}});return b}(),x=(f.pad={}).Pkcs7={pad:function(a,b){for(var c=4*b,c=c-a.sigBytes%c,d=c<<24|c<<16|c<<8|c,e=[],f=0;f<c;f+=4)e.push(d);c=k.create(e,c);a.concat(c)},unpad:function(a){a.sigBytes-=a.words[a.sigBytes-1>>>2]&255}};e.BlockCipher=m.extend({cfg:m.cfg.extend({mode:l,padding:x}),reset:function(){m.reset.call(this);var a=this.cfg;var b=a.iv,c=a.mode;this._xformMode==this._ENC_XFORM_MODE?a=c.createEncryptor:
(a=c.createDecryptor,this._minBufferSize=1);this._mode=a.call(c,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var n=e.CipherParams=h.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),l=(f.format={}).OpenSSL={stringify:function(a){var b=
a.ciphertext;a=a.salt;return(a?k.create([1398893684,1701076831]).concat(a).concat(b):b).toString(q)},parse:function(a){a=q.parse(a);var b=a.words;if(1398893684==b[0]&&1701076831==b[1]){var c=k.create(b.slice(2,4));b.splice(0,4);a.sigBytes-=16}return n.create({ciphertext:a,salt:c})}},g=e.SerializableCipher=h.extend({cfg:h.extend({format:l}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);b=e.finalize(b);e=e.cfg;return n.create({ciphertext:b,key:c,iv:e.iv,algorithm:a,mode:e.mode,
padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,d){d=this.cfg.extend(d);b=this._parse(b,d.format);return a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),f=(f.kdf={}).OpenSSL={execute:function(a,b,c,d){d||(d=k.random(8));a=u.create({keySize:b+c}).compute(a,d);c=k.create(a.words.slice(b),4*c);a.sigBytes=4*b;return n.create({key:a,iv:c,salt:d})}},r=e.PasswordBasedCipher=g.extend({cfg:g.cfg.extend({kdf:f}),
encrypt:function(a,b,c,d){d=this.cfg.extend(d);c=d.kdf.execute(c,a.keySize,a.ivSize);d.iv=c.iv;a=g.encrypt.call(this,a,b,c.key,d);a.mixIn(c);return a},decrypt:function(a,b,c,d){d=this.cfg.extend(d);b=this._parse(b,d.format);c=d.kdf.execute(c,a.keySize,a.ivSize,b.salt);d.iv=c.iv;return g.decrypt.call(this,a,b,c.key,d)}})}();nSaferJS.pad.NoPadding={pad:function(){},unpad:function(){}};
